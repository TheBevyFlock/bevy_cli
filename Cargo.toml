[workspace]
members = ["bevy_lint"]

[package]
edition = "2021"
license = "MIT OR Apache-2.0"
name = "bevy_cli"
version = "0.1.0-dev"
# When no binary is specific, run the main CLI by default.
default-run = "bevy"

# The main CLI executable
[[bin]]
name = "bevy"
path = "src/bin/main.rs"

[features]
default = ["web"]

# Run your Bevy app in the browser
web = [
  "dep:webbrowser",
  "dep:http",
  "dep:axum",
  "dep:tower",
  "dep:tower-http",
  "dep:tokio",
  "dep:fs_extra",
]

# To optimize the Wasm binaries
wasm-opt = ["web"]

# Run your Bevy app in the browser
web = [
  "dep:webbrowser",
  "dep:http",
  "dep:axum",
  "dep:tower",
  "dep:tower-http",
  "dep:tokio",
  "dep:fs_extra",
]

[dependencies]
# CLI argument parsing
clap = {version = "4.5.16", features = ["derive"]}
# autocompletion auto-generation
clap_complete = "4.5.44"

# Easy error propagation and contexts
anyhow = "1.0.86"

# Generates new Bevy projects from templates
cargo-generate = "0.22"

# Better CLI user input
dialoguer = {version = "0.11.0", default-features = false}

# API interaction
regex = "1.10.6"
reqwest = {version = "0.12.7", default-features = false, features = [
  "blocking",
  "json",
]}
serde = {features = ["derive"], version = "1.0.210"}
serde_json = "1.0.128"

# Understanding package versions
semver = {version = "1.0.23", features = ["serde"]}

# Parsing the Cargo manifest
toml_edit = {version = "0.22.22", default-features = false, features = [
  "parse",
]}

# Logging crates
tracing = "0.1.41"
tracing-subscriber = {version = "0.3.19", features = ["env-filter"]}

# Web dependencies

## Opening the app in the browser
webbrowser = {version = "1.0.2", optional = true}

## Serving the app for the browser
axum = {version = "0.8.1", default-features = false, features = [
  "ws",
  "http1",
  "tokio",
  "tracing",
], optional = true}
http = {version = "1.2", optional = true}
tokio = {version = "1.0", features = ["full"], optional = true}
tower = {version = "0.5.2", features = ["util"], optional = true}
tower-http = {version = "0.6.1", features = ["fs", "trace"], optional = true}

## Copying directories
fs_extra = {version = "1.3.0", optional = true}

[build-dependencies]
# We don't use `cc` directly, but our dependency `wasm-opt-sys` fails to compile on Windows when using a newer version.
# This can be removed when https://github.com/rust-lang/cc-rs/issues/1324 is fixed. 
cc = "=1.2.2"

[dev-dependencies]
# Forcing tests that can't be parallelized to be run sequentially
assert_cmd = "2.0.16"
serial_test = "3.2.0"
